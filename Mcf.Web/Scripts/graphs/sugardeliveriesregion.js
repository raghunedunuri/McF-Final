var json = [{ "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.3 }, { "name": "South", "percentage": 2.3 }, { "name": "North Central", "percentage": 2.9 }], "year": "1991/92" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.3 }, { "name": "South", "percentage": 2.4 }, { "name": "North Central", "percentage": 2.9 }], "year": "1992/93" }, { "values": [{ "name": "New England", "value": 0.4 }, { "name": "West", "percentage": 1.3 }, { "name": "Mid Atlantic", "percentage": 1.3 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 2.9 }], "year": "1993/94" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.4 }, { "name": "South", "percentage": 2.7 }, { "name": "North Central", "percentage": 3.0 }], "year": "1994/95" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.3 }, { "name": "Mid Atlantic", "percentage": 2.7 }, { "name": "South", "percentage": 2.4 }, { "name": "North Central", "percentage": 3.1 }], "year": "1995/96" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.3 }, { "name": "South", "percentage": 2.4 }, { "name": "North Central", "percentage": 3.2 }], "year": "1996/97" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.3 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.2 }], "year": "1997/98" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.3 }, { "name": "South", "percentage": 2.7 }, { "name": "North Central", "percentage": 3.1 }], "year": "1998/1999" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.5 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.1 }], "year": "1999/2000" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.1 }], "year": "2000/2001" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.5 }, { "name": "South", "percentage": 2.7 }, { "name": "North Central", "percentage": 3.1 }], "year": "2001/2002" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.3 }, { "name": "Mid Atlantic", "percentage": 1.5 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.1 }], "year": "2002/2003" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.3 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.7 }, { "name": "North Central", "percentage": 3.1 }], "year": "2003/2004" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.3 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.1 }], "year": "2004/2005" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.3 }, { "name": "Mid Atlantic", "percentage": 1.5 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.1 }], "year": "2005/2006" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.3 }, { "name": "North Central", "percentage": 3.2 }], "year": "2006/2007" }, { "values": [{ "name": "New England", "value": 0.3 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.42 }], "year": "2007/2008" }, { "values": [{ "name": "New England", "value": 0.4 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.6 }, { "name": "North Central", "percentage": 3.3 }], "year": "2008/2009" }, { "values": [{ "name": "New England", "value": 0.4 }, { "name": "West", "percentage": 1.5 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.7 }, { "name": "North Central", "percentage": 3.3 }], "year": "2009/2010" }, { "values": [{ "name": "New England", "value": 0.4 }, { "name": "West", "percentage": 1.5 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.7 }, { "name": "North Central", "percentage": 3.3 }], "year": "2010/2011" }, { "values": [{ "name": "New England", "value": 0.4 }, { "name": "West", "percentage": 1.5 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 2.7 }, { "name": "North Central", "percentage": 3.3 }], "year": "2011/2012" }, { "values": [{ "name": "New England", "value": 0.4 }, { "name": "West", "percentage": 1.5 }, { "name": "Mid Atlantic", "percentage": 1.7 }, { "name": "South", "percentage": 3.0 }, { "name": "North Central", "percentage": 3.6 }], "year": "2012/2013" }, { "values": [{ "name": "New England", "value": 0.4 }, { "name": "West", "percentage": 1.5 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 3.1 }, { "name": "North Central", "percentage": 3.6 }], "year": "2013/2014" }, { "values": [{ "name": "New England", "value": 0.5 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.7 }, { "name": "South", "percentage": 3.2 }, { "name": "North Central", "percentage": 3.7 }], "year": "2014/2015" }, { "values": [{ "name": "New England", "value": 0.5 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 3.2 }, { "name": "North Central", "percentage": 3.7 }], "year": "2015/2016" }, { "values": [{ "name": "New England", "value": 0.5 }, { "name": "West", "percentage": 1.4 }, { "name": "Mid Atlantic", "percentage": 1.6 }, { "name": "South", "percentage": 3.4 }, { "name": "North Central", "percentage": 3.7 }], "year": "2016/2017" }];
var _chart, categories = [], data = {};
$(document).ready(function () {

    $.each(json, function (inde, item) {
        $.each(item.values, function (index, item1) {
            console.log(item1)
            object = data[item1.name];
            if (!object) {
                object = [];
                data[item1.name] = object;
            }
            if (item1.value)
                object.push(item1.value)
            if (item1.percentage)
                object.push(item1.percentage)
        });
        categories.push(item.year);
    });

    console.log(data, categories)
    function updateChart() {
        _chart = Highcharts.chart('mapcontainer', {
            chart: {
                type: 'spline',
            },
            title: {
                text: 'U.S. sugar deliveries by region for food use',
                style: {
                    color: '#8B3910',
                    fontSize: '36px',
                    fontWeight: 'normal',
                    fontFamily: 'Cordia New'
                }
            },
            xAxis: {
                categories: categories,
                labels: {
                    overflow: 'justify'
                }
            },
            yAxis: {
                title: {
                    text: 'Million short tons, refined',
                    style: {
                        color: '#8B3910',
                        fontSize: '24px',
                        fontFamily: 'Cordia New'
                    }
                },
            },
            tooltip: {
                formatter: function () {
                    var comment = (this.point.comment) ? '<b>' + this.point.comment + '</b>' : '';
                    return '<b>' + this.x + '</b><br/>' +
                        this.series.name + ': ' + this.y + '<br/>' + comment;
                }
            },
            legend: {
                symbolWidth: 20,
                itemStyle: {
                    color: '#000000',
                    fontWeight: 'normal',
                    fontSize: '13px'
                }
            },
            plotOptions: {
                spline: {
                    lineWidth: 4,
                    states: {
                        hover: {
                            lineWidth: 5
                        }
                    },
                    marker: {
                        enabled: false
                    }
                }
            },
            series: [{
                id: '_1',
                name: 'North Central',
                data: data['North Central'],
                color: '#969E5B',
                marker: {
                    enabled: false
                }
            }, {
                id: '_2',
                name: 'West',
                data: data['West'],
                color: '#A41B09',
                marker: {
                    enabled: false
                }
            }, {
                id: '_3',
                name: 'Mid Atlantic',
                data: data['Mid Atlantic'],
                color: '#2E5C1D',
                marker: {
                    enabled: false
                }
            }, {
                id: '_4',
                name: 'South',
                data: data['South'],
                color: '#DEB305',
                marker: {
                    enabled: false
                }
            }, {
                id: '_4',
                name: 'New England',
                data: data['New England'],
                color: '#E4851D',
                marker: {
                    enabled: false
                }
            }]
        });
    }

    updateChart();
});